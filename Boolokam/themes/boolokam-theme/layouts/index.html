{{ define "main" }}
<div class="home-content">
    <!-- Three-column Hero Section -->
    <div class="hero-section">
        <!-- Column 1: Trending This Week -->
        <div class="column trending-column">
            <div class="column-header">
                <h2>TRENDING THIS WEEK</h2>
            </div>
            <div class="trending-list">
                {{ $trending_articles := where .Site.RegularPages "Section" "in" (slice "news" "videos" "movies") }}
                {{ $trending_articles := where $trending_articles "Params.view_count" ">" 0 }}
                {{ $trending_articles := $trending_articles.ByParam "view_count" }}
                {{ $trending_articles := $trending_articles.Reverse }}
                {{ $top_articles := first 5 $trending_articles }}
                
                {{ range $index, $article := $top_articles }}
                <div class="trending-item">
                    <a href="{{ $article.RelPermalink }}" class="full-card-link" aria-label="Read {{ $article.Title }}"></a>
                    <div class="trending-number">{{ add $index 1 }}</div>
                    <div class="trending-content">
                        <div class="trending-category">{{ upper (index $article.Params.categories 0) }}<span class="trending-date">• {{ $article.Date.Format "Jan 02, 2006" }}</span></div>
                        <h4><a href="{{ $article.RelPermalink }}">{{ $article.Title }}</a></h4>
                        <div class="trending-stats">
                            <span class="trending-views"><i class="fas fa-eye"></i> {{ partial "format-number.html" $article.Params.view_count }}</span>
                            <span class="trending-likes"><i class="far fa-heart"></i> {{ if $article.Params.like_count }}{{ partial "format-number.html" $article.Params.like_count }}{{ else }}423{{ end }}</span>
                            <span class="trending-comments"><i class="far fa-comment"></i> {{ if $article.Params.comment_count }}{{ partial "format-number.html" $article.Params.comment_count }}{{ else }}89{{ end }}</span>
                            <span class="trending-shares"><i class="far fa-share-square"></i> {{ if $article.Params.share_count }}{{ partial "format-number.html" $article.Params.share_count }}{{ else }}67{{ end }}</span>
                        </div>
                    </div>
                </div>
                {{ end }}
            </div>
        </div>

        <!-- Column 2: Featured Articles -->
        <div class="column featured-column">
            <div class="column-content">
                {{ $featured := where .Site.RegularPages "Params.categories" "intersect" (slice "Featured") | last 3 }}
                {{ if eq (len $featured) 0 }}
                    {{ $featured = first 3 (where .Site.RegularPages "Type" "news") }}
                {{ end }}
                
                <!-- Primary Featured Article (Full Width) -->
                {{ with index $featured 0 }}
                <div class="featured-primary">
                    <a href="{{ .RelPermalink }}" class="full-card-link" aria-label="Read {{ .Title }}"></a>
                    <div class="featured-image">
                        {{ if .Params.image }}
                        <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}">
                        {{ else }}
                        <img src="{{ "images/samples/news/general/default.jpg" | relURL }}" alt="{{ .Title }}">
                        {{ end }}
                        <div class="featured-category-tag">
                            {{ upper (index .Params.categories 0) }}
                        </div>
                    </div>
                    <div class="featured-content">
                        <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                        <div class="featured-date-bottom">{{ .Date.Format "Jan 02, 2006" }}</div>
                        <div class="post-stats">
                            <span><i class="fas fa-eye"></i> {{ if .Params.view_count }}{{ partial "format-number.html" .Params.view_count }}{{ else }}1.5K{{ end }}</span>
                            <span><i class="far fa-heart"></i> 77</span>
                            <span><i class="far fa-comment"></i> 28</span>
                            <span><i class="far fa-share-square"></i> 67</span>
                        </div>
                    </div>
                </div>
                {{ end }}
                
                <!-- Secondary Featured Articles (Two in a Row) -->
                <div class="featured-secondary-row">
                    {{ range after 1 $featured }}
                    <div class="featured-secondary">
                        <a href="{{ .RelPermalink }}" class="full-card-link" aria-label="Read {{ .Title }}"></a>
                        <div class="featured-image">
                            {{ if .Params.image }}
                            <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}">
                            {{ else }}
                            <img src="{{ "images/samples/news/general/default.jpg" | relURL }}" alt="{{ .Title }}">
                            {{ end }}
                            <div class="featured-category-tag">
                                {{ upper (index .Params.categories 0) }}
                            </div>
                        </div>
                        <div class="featured-content">
                            <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                            <div class="featured-date-bottom">{{ .Date.Format "Jan 02, 2006" }}</div>
                            <div class="post-stats">
                                <span><i class="fas fa-eye"></i> {{ if .Params.view_count }}{{ partial "format-number.html" .Params.view_count }}{{ else }}1.5K{{ end }}</span>
                                <span><i class="far fa-heart"></i> 77</span>
                                <span><i class="far fa-comment"></i> 28</span>
                                <span><i class="far fa-share-square"></i> 67</span>
                            </div>
                        </div>
                    </div>
                    {{ end }}
                </div>
            </div>
        </div>

        <!-- Column 3: Latest Movies and Videos (Tabbed) -->
        <div class="column latest-column">
            <div class="column-header">
                <h2>LATEST MOVIES AND VIDEOS</h2>
            </div>
            <div class="tabs-header">
                <button class="tab-button active" data-tab="videos">VIDEOS</button>
                <button class="tab-button" data-tab="movies">MOVIES</button>
            </div>
            <div class="column-content">
                <!-- Videos Tab -->
                <div id="videos-tab" class="tab-content active">
                    {{ range first 5 (where .Site.RegularPages "Type" "videos") }}
                    <div class="latest-item">
                        <a href="{{ .RelPermalink }}" class="full-card-link" aria-label="Read {{ .Title }}"></a>
                        <div class="latest-thumb">
                            {{ if .Params.image }}
                            <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}">
                            {{ else }}
                            <img src="{{ "images/samples/videos/default.jpg" | relURL }}" alt="{{ .Title }}">
                            {{ end }}
                            <div class="play-icon">
                                <i class="fas fa-play-circle"></i>
                            </div>
                        </div>
                        <div class="latest-details">
                            <div class="latest-category">
                                {{ with .Params.categories }}
                                <span class="category">{{ upper (index . 0) }}</span>
                                {{ end }}
                                <span class="date">• {{ .Date.Format "Jan 02, 2006" }}</span>
                            </div>
                            <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                            <div class="post-stats">
                                <span><i class="fas fa-eye"></i> {{ if .Params.view_count }}{{ partial "format-number.html" .Params.view_count }}{{ else }}8.5K{{ end }}</span>
                                <span><i class="far fa-heart"></i> 423</span>
                                <span><i class="far fa-comment"></i> 89</span>
                            </div>
                        </div>
                    </div>
                    {{ end }}
                </div>
                
                <!-- Movies Tab -->
                <div id="movies-tab" class="tab-content">
                    {{ range first 5 (where .Site.RegularPages "Type" "movies") }}
                    <div class="latest-item">
                        <a href="{{ .RelPermalink }}" class="full-card-link" aria-label="Read {{ .Title }}"></a>
                        <div class="latest-thumb">
                            {{ if .Params.image }}
                            <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}">
                            {{ else }}
                            <img src="{{ "images/samples/movies/default.jpg" | relURL }}" alt="{{ .Title }}">
                            {{ end }}
                            <div class="play-icon">
                                <i class="fas fa-play-circle"></i>
                            </div>
                        </div>
                        <div class="latest-details">
                            <div class="latest-category">
                                {{ with .Params.categories }}
                                <span class="category">{{ upper (index . 0) }}</span>
                                {{ end }}
                                <span class="date">• {{ .Date.Format "Jan 02, 2006" }}</span>
                            </div>
                            <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                            <div class="post-stats">
                                <span><i class="fas fa-eye"></i> {{ if .Params.view_count }}{{ partial "format-number.html" .Params.view_count }}{{ else }}6.3K{{ end }}</span>
                                <span><i class="far fa-heart"></i> 312</span>
                                <span><i class="far fa-comment"></i> 67</span>
                            </div>
                        </div>
                    </div>
                    {{ end }}
                </div>
            </div>
        </div>
    </div>

    <!-- Rest of content sections -->
    <section class="latest-news-section">
        <div class="section-title">
            <h2>Latest News</h2>
            <a href="{{ "news" | relURL }}" class="view-all">View All</a>
        </div>
        <div class="grid-container">
            {{ $latestNews := where .Site.RegularPages "Type" "news" }}
            {{ range first 24 $latestNews }}
            <div class="grid-item">
                <div class="card">
                    <a href="{{ .RelPermalink }}" class="full-card-link" aria-label="Read {{ .Title }}"></a>
                    {{ if .Params.image }}
                    <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}">
                    {{ else }}
                    <img src="{{ "images/samples/news/general/default.jpg" | relURL }}" alt="{{ .Title }}">
                    {{ end }}
                    <div class="featured-category-tag">
                        {{ with .Params.categories }}{{ upper (index . 0) }}{{ end }}
                    </div>
                    <div class="card-content">
                        <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                        <p class="post-meta">{{ .Date.Format "Jan 2, 2006" }}</p>
                        <div class="post-stats">
                            <span><i class="fas fa-eye"></i> {{ if .Params.view_count }}{{ partial "format-number.html" .Params.view_count }}{{ else }}1.5K{{ end }}</span>
                            <span><i class="far fa-heart"></i> {{ if .Params.like_count }}{{ partial "format-number.html" .Params.like_count }}{{ else }}77{{ end }}</span>
                            <span><i class="far fa-comment"></i> {{ if .Params.comment_count }}{{ partial "format-number.html" .Params.comment_count }}{{ else }}28{{ end }}</span>
                            <span><i class="far fa-share-square"></i> {{ if .Params.share_count }}{{ partial "format-number.html" .Params.share_count }}{{ else }}15{{ end }}</span>
                        </div>
                    </div>
                </div>
            </div>
            {{ end }}
        </div>
    </section>
</div>

<!-- Add JavaScript for tabs -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const tabButtons = document.querySelectorAll('.tab-button');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all buttons and tabs
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            
            // Add active class to clicked button
            this.classList.add('active');
            
            // Show the corresponding tab
            const tabId = this.getAttribute('data-tab') + '-tab';
            document.getElementById(tabId).classList.add('active');
        });
    });
});
</script>
{{ end }} 